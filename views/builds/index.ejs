<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="/stylesheets/style.css">
  <link rel="stylesheet" href="/stylesheets/buildPage.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
  <script defer src="/javascripts/drag_script.js"></script>
  <title>Pasta-fy</title>
</head>
<body class="container">
  <nav class="navbar fixed-top">
    <a class="navbar-brand" id="pastafyLogo" href="/"><img src="https://cdn.iconscout.com/icon/premium/png-256-thumb/penne-pasta-3113269-2597347.png"><span class="navbar-brand">PASTA-FY</span></a>
    <div class="navbarLinks">
      <a href="/ingredients">EXPLORE</a>
      <% if (user) { %>
        <a href="/builds">BUILD</a>
        <a href="/logout">LOG OUT</a>
      <% } else { %>
        <a href="/auth/google" class="login">LOG IN</a>
      <% } %>
    </div>
  </nav>
<br><br>

<h1 class="display-5"><strong>Build Your Personal Pasta:</strong></h1>
<hr>
<!-- HAVE AN AUTO GENERATE FUNCTION -->

<div class="d-flex justify-content-between">
  <!-- Lists all ingredients selected in Explore page separated by category -->
  <div class="selected-container">
    <h1 class="fs-2"><u>Selected Ingredients:</u></h1><br>
    <h5>Pasta</h5>
    <div class="textBgBuild">
      <% if (build) { %>
        <% build.pasta.forEach(bp=> { %>
          <div class="d-flex justify-content-between">
            <%= bp.name %>
            <form action="/pasta/<%= bp._id %>?_method=DELETE" method="POST">
              <button class="btn btn-danger btn-sm deleteBtn" type="submit">X</button>
            </form>
          </div><br>
        <% }) %>
      <% } %>
      <% if (!build.pasta.length) { %>
        - None selected - <br>
      <% } %>
    </div><br>

    <h5>Sauce</h5>
    <div class="textBgBuild">
      <% if (build) { %>
        <% build.sauce.forEach(bs=> { %>
          <div class="d-flex justify-content-between">
            <%= bs.name %>
            <form action="/sauce/<%= bs._id %>?_method=DELETE" method="POST">
              <button class="btn btn-danger btn-sm deleteBtn" type="submit">X</button>
            </form>
          </div><br>
        <% }) %>
      <% } %>
      <% if (!build.sauce.length) { %>
        - None selected - <br>
      <% } %>
    </div><br>

    <h5>Vegetables</h5>
    <div class="textBgBuild">
      <% if (build) { %>
        <% build.vege.forEach(bv=> { %>
          <div class="d-flex justify-content-between">
            <%= bv.name %>
            <form action="/vege/<%= bv._id %>?_method=DELETE" method="POST">
              <button class="btn btn-danger btn-sm deleteBtn" type="submit">X</button>
            </form>
          </div><br>
        <% }) %>
      <% } %>
      <% if (!build.vege.length) { %>
        - None selected - <br>
      <% } %>
    </div><br>

    <h5>Protein</h5>
    <div class="textBgBuild">
      <% if (build) { %>
        <% build.protein.forEach(bp=> { %>
          <div class="d-flex justify-content-between">
            <%= bp.name %>
            <form action="/protein/<%= bp._id %>?_method=DELETE" method="POST">
              <button class="btn btn-danger btn-sm deleteBtn" type="submit">X</button>
            </form>
          </div><br>
        <% }) %>
      <% } %>
      <% if (!build.protein.length) { %>
        - None selected - <br>
      <% } %>
    </div>
  </div>

  <div class="verticalLine2"></div>

  <!-- List all the ingredients on the left but in selectable form for dish generation -->
  <div class="textBgCombine combine-container">
    <% if (build) { %>
      <h5 class="fs-4">Combine ingredients into dish!</h5><hr>
      <form action="/builds" method="POST">
  
        <label id="combinePasta">Pasta</label><br>
          <select name="pasta" class="form-control form-control-sm" required oninvalid="this.setCustomValidity('Please add a pasta from Explore page')" oninput="setCustomValidity('')">
            <% build.pasta.forEach(bp=> { %>
              <option value="<%= bp._id %>"><%= bp.name %></option>
            <% }) %>
          </select><br>
        <label id="combineSauce">Sauce</label><br>
          <select name="sauce" class="form-control form-control-sm" required oninvalid="this.setCustomValidity('Please add a sauce from Explore page')" oninput="setCustomValidity('')">
            <% build.sauce.forEach(bs=> { %>
              <option value="<%= bs._id %>"><%= bs.name %></option>
            <% }) %>
          </select><hr>
        <label id="combineVege">Vegetable</label><br>
          <% build.vege.forEach(bv=> { %>
            <input type="checkbox" value="<%= bv.id %>" name="vege"> <%= bv.name %><br>
          <% }) %>
          <% if (!build.vege.length) { %>
            - None selected - <br>
          <% } %>
          <br>
        <label id="combineProtein">Protein</label><br>
          <% build.protein.forEach(bp=> { %>
            <input  type="checkbox" value="<%= bp.id %>" name="protein"> <%= bp.name %><br>
          <% }) %>
          <% if (!build.protein.length) { %>
            - None selected - <br>
          <% } %>
          <br>
        <label id="combineName">NAME YOUR DISH!</label><br>
        <input class="form-control form-control-sm" name="mealName" type="text" placeholder="Bestest Pasta-iest Pasta" required>

        <button class="button-82-pushable" type="submit" role="button">
          <span class="button-82-shadow"></span>
          <span class="button-82-edge"></span>
          <span class="button-82-front text">
            COOK
          </span>
        </button>
        
      </form>
    <% } %>
  </div>

</div>

<%- include('../partials/footer') %>
