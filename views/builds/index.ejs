<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="/stylesheets/style.css">
  <link rel="stylesheet" href="/stylesheets/buildPage.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
  <script defer src="/javascripts/drag_script.js"></script>
  <title>Pasta-fy</title>
</head>
<body class="container">
  <nav class="navbar fixed-top">
    <a class="navbar-brand" id="pastafyLogo" href="/"><img src="https://cdn.iconscout.com/icon/premium/png-256-thumb/penne-pasta-3113269-2597347.png"><span class="navbar-brand">PASTA-FY</span></a>
    <div class="navbarLinks">
      <a href="/ingredients">Explore</a>
      <% if (user) { %>
        <a href="#">Products</a>
        <a href="/builds">Build</a>
        <a href="/logout">LOG OUT</a>
      <% } else { %>
        <a href="/auth/google" class="login">LOG IN</a>
      <% } %>
    </div>
  </nav>
<br><br><br><br><br>

<h1 class="display-1">Build Your Pasta Here:</h1>
<hr>
<!-- HAVE AN AUTO GENERATE FUNCTION -->

<div class="d-flex justify-content-between">
  <!-- Lists all ingredients selected in Explore page separated by category -->
  <div class="selected-container">

    <h5>Pasta</h5>
    <div class="textBgBuild">
      <% if (build) { %>
        <% build.pasta.forEach(bp=> { %>
          <div class="d-flex justify-content-between">
            <%= bp.name %>
            <form action="/pasta/<%= bp._id %>?_method=DELETE" method="POST">
              <button class="btn btn-danger btn-sm deleteBtn" type="submit">X</button>
            </form>
          </div><br>
        <% }) %>
      <% } %>
    </div><br>

    <h5>Sauce</h5>
    <div class="textBgBuild">
      <% if (build) { %>
        <% build.sauce.forEach(bs=> { %>
          <div class="d-flex justify-content-between">
            <%= bs.name %>
            <form action="/sauce/<%= bs._id %>?_method=DELETE" method="POST">
              <button class="btn btn-danger btn-sm deleteBtn" type="submit">X</button>
            </form>
          </div><br>
        <% }) %>
      <% } %>
    </div><br>

    <h5>Vegetables</h5>
    <div class="textBgBuild">
      <% if (build) { %>
        <% build.vege.forEach(bv=> { %>
          <div class="d-flex justify-content-between">
            <%= bv.name %>
            <form action="/vege/<%= bv._id %>?_method=DELETE" method="POST">
              <button class="btn btn-danger btn-sm deleteBtn" type="submit">X</button>
            </form>
          </div><br>
        <% }) %>
      <% } %>
    </div><br>

    <h5>Protein</h5>
    <div class="textBgBuild">
      <% if (build) { %>
        <% build.protein.forEach(bp=> { %>
          <div class="d-flex justify-content-between">
            <%= bp.name %>
            <form action="/protein/<%= bp._id %>?_method=DELETE" method="POST">
              <button class="btn btn-danger btn-sm deleteBtn" type="submit">X</button>
            </form>
          </div><br>
        <% }) %>
      <% } %>
    </div>
  </div>

  <!-- SHOW INGREDIENTS READY TO COMBINE ON RIGHT OF PAGE -->
  <div class="textBgCombine combine-container">
    <% if (build) { %>
      <h5>Combine ingredients into dish!</h5>
      <form action="/builds" method="POST">
  
        <label>Pasta</label>
          <select name="pasta" required oninvalid="this.setCustomValidity('Please add a pasta from Explore page')" oninput="setCustomValidity('')">
            <% build.pasta.forEach(bp=> { %>
              <option value="<%= bp._id %>"><%= bp.name %></option>
            <% }) %>
          </select><br>
        <label>Sauce</label>
          <select name="sauce" required oninvalid="this.setCustomValidity('Please add a sauce from Explore page')" oninput="setCustomValidity('')">
            <% build.sauce.forEach(bs=> { %>
              <option value="<%= bs._id %>"><%= bs.name %></option>
            <% }) %>
          </select><br>
        <label>Vegetable</label><br>
          <% build.vege.forEach(bv=> { %>
            <input type="checkbox" value="<%= bv.id %>" name="vege"><%= bv.name %><br>
          <% }) %><br>
        <label>Protein</label><br>
          <% build.protein.forEach(bp=> { %>
            <input type="checkbox" value="<%= bp.id %>" name="protein"><%= bp.name %><br>
          <% }) %><br>
  
        <label>Name your dish!</label><br>
        <input name="mealName" type="text" placeholder="Bestest Pasta-iest Pasta" required>
        <br><br>
        <button class="btn btn-primary" type="submit">Cook!</button>
  
      </form>
    <% } %>
  </div>

</div>

<%- include('../partials/footer') %>